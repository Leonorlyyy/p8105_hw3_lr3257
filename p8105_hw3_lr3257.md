p8105_hw3_lr3257
================
Leonor Rui
2024-10-06

# Homework 3

## Problem 1

### Description:

The ny_noaa dataset has 2595176 observations and 7 variables. Key
variables include date (categorical, date of the weather), prcp
(numeric, precipitation in millimeters), snow (numeric, 24-hr snowfall
in centimeters), snwd (numeric, accumulated snow depth in inches), tmax
(numeric, maximal temperature), tmin(numeric, minimum temperature).

``` r
na_counts <- sapply(ny_noaa, function(x) sum(is.na(x)))
na_counts
```

    ##      id    date    prcp    snow    snwd    tmax    tmin 
    ##       0       0  145838  381221  591786 1134358 1134420

As the numbers above shows, quite a large proportion of the observations
in this dataset contains NA values, especially for the tmax and tmin
variables. These missing values would be a problem for future data
analysis, and we should find a way to avoid it.

- Do some data cleaning. Create separate variables for year, month, and
  day. Ensure observations for temperature, precipitation, and snowfall
  are given in reasonable units. For snowfall, what are the most
  commonly observed values? Why?

``` r
ny_df = ny_noaa |>
  drop_na(tmin, tmax) |>
  mutate(
    date = as.character(date),
    tmin = as.numeric(tmin),
    tmax = as.numeric(tmax),
    tmin = tmin / 10,
    tmax = tmax / 10
  ) |>
  separate(date, into = c("year", "month", "day"), sep = "-")
print(ny_df, n=10)
```

    ## # A tibble: 1,458,900 × 9
    ##    id          year  month day    prcp  snow  snwd  tmax  tmin
    ##    <chr>       <chr> <chr> <chr> <int> <int> <int> <dbl> <dbl>
    ##  1 USC00300023 1981  01    03        0     0     0 -12.2 -20.6
    ##  2 USC00300023 1981  01    05        0     0     0  -5.6 -17.8
    ##  3 USC00300023 1981  01    12        0     0     0 -12.2 -30.6
    ##  4 USC00300023 1981  01    13        0     0     0  -6.7 -28.9
    ##  5 USC00300023 1981  01    15        0     0     0  -5   -10.6
    ##  6 USC00300023 1981  01    17        0     0     0  -1.1 -15  
    ##  7 USC00300023 1981  01    20        0     0     0   6.1  -6.7
    ##  8 USC00300023 1981  01    21        0     0     0   1.7 -10.6
    ##  9 USC00300023 1981  01    22        0     0     0   0.6  -5  
    ## 10 USC00300023 1981  01    23      117   127    76   2.2  -4.4
    ## # ℹ 1,458,890 more rows

``` r
snow_table = ny_df |>
  pull(snow) |>
  table() 

snow_mode = names(sort(snow_table, decreasing = TRUE))[1]
```

The most commonly observed value for snow is 0, since there is no snow
for most times of the year.

- Make a two-panel plot showing the average max temperature in January
  and in July in each station across years. Is there any observable /
  interpretable structure? Any outliers?

``` r
ny_df |>
  filter(month %in% c("01", "07")) |>
  group_by(year, month, id) |>
  summarize(mean_tmax = mean(tmax)) |>
  ggplot(aes(x = year, y = mean_tmax)) +
  geom_boxplot() +
  facet_grid(.~month) +
  labs(
    title = "Monthly Average Maximum Temperature in January and July" ,
    x = "year",
    y = "Average Max Temperature"
  ) +
  theme(aspect.ratio = 1/2) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```

    ## `summarise()` has grouped output by 'year', 'month'. You can override using the
    ## `.groups` argument.

![](p8105_hw3_lr3257_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

The average max temperature in Januray generally has a positively skewed
distribution across different years, meaning there were often some
relatively warm days in January. In 1982 and 2005, there are 2
noticeable negative outliers that are below -10 Fahrenheit Conversely,
the average max temperature in July generally has a negatively skewed
distribution across the years, meaning there were often some relatively
cool days in July. There is one quite extreme outlier in 1988, which
represents the mean tmax of the station lower than 15 Fahrenheit, a very
cold July.

- Make a two-panel plot showing (i) tmax vs tmin for the full dataset
  (note that a scatterplot may not be the best option); and (ii) make a
  plot showing the distribution of snowfall values greater than 0 and
  less than 100 separately by year.

``` r
tmin_tmax = ny_df |>
  ggplot(aes(x = tmin, y = tmax)) +
  geom_hex() +
  labs(
    title = "Hex Plot of Maximum vs. Minimum Temperatures",
    x = "Minimum Temperature (°F)",
    y = "Maximum Temperature (°F)"
  )

snowfall = ny_df |>
  filter(snow > 0, snow < 100) |>
  group_by(year) |>
  ggplot(aes(x = snow, y = year)) +
  geom_density_ridges() +
  labs(
    title = "Density Plots of Snowfall (0~100) by Year",
    x = "Snowfall Depth (cm)",
    y = "year"
  )

(tmin_tmax + snowfall) +
  plot_layout(ncol = 2, widths = c(1, 1))
```

    ## Picking joint bandwidth of 4.16

![](p8105_hw3_lr3257_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

## Problem 2
